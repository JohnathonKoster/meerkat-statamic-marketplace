{"version":3,"sources":["replies.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"reply-to.js","sourcesContent":["(function () {\r\n    var MeerkatReply = {\r\n        Endpoints: Object.freeze({\r\n            SubmitComment: '/!/Meerkat/socialize'\r\n        }),\r\n        closeOnCancel: true,\r\n        replyOpen: null,\r\n        canceled: null,\r\n        submit: function (event) {\r\n            \r\n        },\r\n        getOpenReplyForm: function () {\r\n            var forms = document.querySelectorAll('form[data-meerkat-form=\"comment-reply-form\"]');\r\n\r\n            return forms[forms.length - 1];\r\n        }\r\n    };\r\n    var MeerkatForms = {\r\n        data: {\r\n            ReplyForm: null,\r\n            Extend: null\r\n        },\r\n        findClosest: function (el, selector) {\r\n            var matchesFn;\r\n\r\n            ['matches','webkitMatchesSelector','mozMatchesSelector','msMatchesSelector','oMatchesSelector'].some(function(fn) {\r\n                if (typeof document.body[fn] == 'function') {\r\n                    matchesFn = fn;\r\n                    return true;\r\n                }\r\n                return false;\r\n            })\r\n\r\n            var parent;\r\n\r\n            while (el) {\r\n                parent = el.parentElement;\r\n                if (parent && parent[matchesFn](selector)) {\r\n                    return parent;\r\n                }\r\n                el = parent;\r\n            }\r\n\r\n            return null;\r\n        },\r\n        getReplyForm: function () {\r\n            var form = document.querySelectorAll('[data-meerkat-form=\"comment-reply-form\"]');\r\n\r\n            if (form.length == 0) {\r\n                form = document.querySelectorAll('[data-meerkat-form=\"comment-form\"]');\r\n            }\r\n\r\n            if (form.length > 0) {\r\n                this.data.ReplyForm = form[0].cloneNode(true);\r\n            }\r\n\r\n        },\r\n        makeReplyInput: function (replyingTo) {\r\n            var replyInput = document.createElement('input');\r\n            replyInput.type = 'hidden';\r\n            replyInput.value = replyingTo;\r\n            replyInput.name = 'ids';\r\n\r\n            return replyInput;\r\n        },\r\n        addEventListeners: function () {\r\n            var _this = this;\r\n             var replyLinks = document.querySelectorAll('[data-meerkat-form=\"reply\"]');\r\n\r\n             replyLinks.forEach(function (el) {\r\n                el.addEventListener('click', function (event) {\r\n                    var replyingTo = event.target.getAttribute('data-meerkat-reply-to');\r\n\r\n                    _this.data.ReplyForm.appendChild(_this.makeReplyInput(replyingTo));\r\n                    _this.data.ReplyForm.addEventListener('submit', _this.data.Extend.submit, false);\r\n\r\n                    if (typeof MeerkatForms.data.Extend.replyOpen !== 'undefined' && MeerkatForms.data.Extend.replyOpen !== null) {\r\n                        MeerkatForms.data.Extend.replyOpen(_this.data.ReplyForm);\r\n                    }\r\n                    \r\n                    el.parentNode.insertBefore(_this.data.ReplyForm, el.nextSibling);\r\n                    _this.addCancelReplyListeners();\r\n                    event.preventDefault();\r\n                });\r\n             });\r\n        },\r\n        replyHandler: function (event) {\r\n            var meerkatForm = MeerkatForms.findClosest(event.target, '[data-meerkat-form]');\r\n\r\n            if (typeof meerkatForm !== 'undefined' && meerkatForm !== null) {\r\n                \r\n                var replyingTo = meerkatForm.querySelectorAll('[name=ids]')[0].value;\r\n\r\n                if (typeof MeerkatForms.data.Extend.canceled !== 'undefined' && MeerkatForms.data.Extend.canceled !== null) {\r\n                    MeerkatForms.data.Extend.canceled(replyingTo, meerkatForm);\r\n                }\r\n\r\n                if (MeerkatForms.data.Extend.closeOnCancel) {\r\n                    this.removeEventListener('click', MeerkatForms.replyHandler);\r\n                    meerkatForm.remove();\r\n                }\r\n            }\r\n\r\n            event.preventDefault();\r\n        },\r\n        addCancelReplyListeners: function () {\r\n            var _this = this;\r\n            var cancelLinks = document.querySelectorAll('[data-meerkat-form=\"cancel-reply\"]');\r\n\r\n            cancelLinks.forEach(function (el) {\r\n                el.addEventListener('click', _this.replyHandler);\r\n            });\r\n        },\r\n        init: function () {\r\n            this.data.Extend = MeerkatReply;\r\n            this.getReplyForm();\r\n            this.addEventListeners();\r\n            window.MeerkatReply = this.data.Extend;\r\n        }\r\n    };\r\n\r\n    MeerkatForms.init();\r\n})();"]}